services:
  wholebody-pose-gpu:
    build:
      context: ..                       # ðŸ‘ˆ el build context es el root
      dockerfile: docker/Dockerfile.gpu
    image: wholebody-pose-gpu          # ðŸ‘ˆ fuerza el nombre de la imagen
    container_name: wholebody-pose-gpu # ðŸ‘ˆ nombre del contenedor
    runtime: nvidia
    deploy:
      resources:
        reservations:
          devices:
            - capabilities: [gpu]
        limits:
          memory: 8g
          cpus: '4.0'
    volumes:
      - ../:/workspace
    ports:
      - "8888:8888"
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility
      - DISPLAY=host.docker.internal:0.0
    stdin_open: true
    tty: true

# from root of the project:
#docker compose -f docker/docker-compose-gpu.yaml up --build
